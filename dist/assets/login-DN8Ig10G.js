import{c as f,R as e,r}from"./globals-D-CxY8t_.js";import{g as p}from"./fingerprint-CD_ZU4Rz.js";function g(){const[n,o]=r.useState({email:"",password:""}),[c,t]=r.useState(""),[u,i]=r.useState(!1),[m,d]=r.useState(null);r.useEffect(()=>{new URLSearchParams(window.location.search).get("message")==="session-expired"&&t("Session expired on another device"),p().then(a=>d(a)),fetch("/api/auth/status",{credentials:"include"}).then(a=>{if(a.status===401){window.location.href="/login?message=session-expired";return}return a.json()}).then(a=>{a&&(a.status==="admin"?window.location.href="/admin":(a.status==="approved"||a.status==="pending")&&(window.location.href="/"))})},[]);const h=async s=>{if(s.preventDefault(),t(""),i(!0),!m){t("Device fingerprint not ready. Please wait..."),i(!1);return}try{const l=await fetch("/api/auth/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,...m})});if(l.status===401){t("Invalid email or password"),i(!1);return}const a=await l.json();a.success?a.status==="admin"?window.location.href="/admin":(a.status,window.location.href="/"):t(a.error||"Login failed")}catch{t("Network error. Please try again.")}finally{i(!1)}};return e.createElement("div",{className:"auth-container"},e.createElement("div",{className:"auth-card"},e.createElement("div",{className:"auth-header"},e.createElement("div",{className:"auth-logo"},"T"),e.createElement("h1",{className:"auth-title"},"Welcome Back"),e.createElement("p",{className:"auth-subtitle"},"Sign in to your TubeKit account")),e.createElement("form",{onSubmit:h,className:"auth-form"},c&&e.createElement("div",{className:"auth-error"},c),e.createElement("div",{className:"auth-field"},e.createElement("label",{className:"auth-label"},"Email Address"),e.createElement("input",{type:"email",value:n.email,onChange:s=>o({...n,email:s.target.value}),placeholder:"Enter your email",className:"auth-input",required:!0})),e.createElement("div",{className:"auth-field"},e.createElement("label",{className:"auth-label"},"Password"),e.createElement("input",{type:"password",value:n.password,onChange:s=>o({...n,password:s.target.value}),placeholder:"Enter your password",className:"auth-input",required:!0})),e.createElement("button",{type:"submit",disabled:u,className:"auth-btn"},u?"Signing in...":"Sign In")),e.createElement("div",{className:"auth-footer"},e.createElement("p",{className:"auth-footer-text"},"Don't have an account?"," ",e.createElement("a",{href:"/",className:"auth-link"},"Request Invite")))))}f(document.getElementById("root")).render(e.createElement(g,null));
